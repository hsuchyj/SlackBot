{"version":3,"sources":["../src/apis/AADRequestAPI.ts"],"names":[],"mappings":"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","file":"AADRequestAPI.js","sourcesContent":["import * as request from \"request\";\n// import * as builder from \"botbuilder\";\nlet http = require(\"http\");\n// import { VSTSTokenOAuth2API } from \"./VSTSTokenOAuth2API\";\n// import { DialogIds } from \"../utils/DialogIds\";\n// import { Strings } from \"../locale/locale\";\n\n// Callback for HTTP requests\nexport interface RequestCallback {\n    (error: any, body?: any): void;\n}\n\n// API wrapper\nexport class AADRequestAPI {\n\n    // Creates a new request wrapper for a given API.\n    constructor() {\n        // do nothing\n    }\n\n    // private isUserValidated(session: builder.Session): boolean {\n    //     let isValidated = session.userData &&\n    //         session.userData.vstsAuth &&\n    //         session.userData.vstsAuth.isValidated;\n\n    //     if (!isValidated) {\n    //         session.send(Strings.need_to_log_in);\n    //         session.beginDialog(DialogIds.VSTSLogInDialogId);\n    //     }\n\n    //     return isValidated;\n    // }\n\n    // private async getAccessToken(session: builder.Session): Promise<any> {\n    //     if (!this.isUserValidated(session)) {\n    //         return null;\n    //     }\n\n    //     let auth = new VSTSTokenOAuth2API();\n    //     // sets tokens in session.userData.vstsAuth.token and session.userData.vstsAuth.refreshToken\n    //     await auth.refreshTokens(session);\n\n    //     session.sendTyping();\n\n    //     let args = { vsts_access_token: session.userData.vstsAuth.token };\n\n    //     return args;\n    // };\n\n    // Make a GET request to API.\n    // Syntax: .get(uri, [query], callback)\n    private get(url: string, headers: any, bodyOrCallback?: any | RequestCallback, callback?: RequestCallback): void {\n        this.request(\"GET\", url, headers, bodyOrCallback, callback);\n    };\n\n    // tslint:disable-next-line:member-ordering\n    public async getAsync(url: string, headers: any, body: any): Promise<any> {\n        // let args = await this.getAccessToken(session);\n        // if (!args) {\n        //     return null;\n        // }\n\n        return new Promise((resolve, reject) => {\n            this.get(url, headers, body, (err, result) => {\n                if (!err) {\n                    resolve(result);\n                } else {\n                    reject(err);\n                }\n            });\n        });\n    };\n\n    // Make a DELETE request to API.\n    // Syntax: .delete(uri, [query], callback)\n    private del(url: string, headers: any, bodyOrCallback?: any | RequestCallback, callback?: RequestCallback): void {\n        this.request(\"DELETE\", url, headers, bodyOrCallback, callback);\n    };\n\n    // tslint:disable-next-line:member-ordering\n    public async delAsync(url: string, headers: any, body: any): Promise<any> {\n        // let args = await this.getAccessToken(session);\n        // if (!args) {\n        //     return null;\n        // }\n\n        return new Promise((resolve, reject) => {\n            this.del(url, headers, body, (err, result) => {\n                if (!err) {\n                    resolve(result);\n                } else {\n                    reject(err);\n                }\n            });\n        });\n    };\n\n    // Make a POST request to API.\n    // Syntax: .post(uri, [query], callback)\n    private post(url: string, headers: any, bodyOrCallback?: any | RequestCallback, callback?: RequestCallback): void {\n        this.request(\"POST\", url, headers, bodyOrCallback, callback);\n    };\n\n    // tslint:disable-next-line:member-ordering\n    public async postAsync(url: string, headers: any, body: any): Promise<any> {\n        // let args = await this.getAccessToken(session);\n        // if (!args) {\n        //     return null;\n        // }\n\n        return new Promise((resolve, reject) => {\n            this.post(url, headers, body, (err, result) => {\n                if (!err) {\n                    resolve(result);\n                } else {\n                    reject(err);\n                }\n            });\n        });\n    };\n\n    // Make a PUT request to API.\n    // Syntax: .put(uri, [query], callback)\n    private put(url: string, headers: any, bodyOrCallback?: any | RequestCallback, callback?: RequestCallback): void {\n        this.request(\"PUT\", url, headers, bodyOrCallback, callback);\n    };\n\n    // tslint:disable-next-line:member-ordering\n    public async putAsync(url: string, headers: any, body: any): Promise<any> {\n        // let args = await this.getAccessToken(session);\n        // if (!args) {\n        //     return null;\n        // }\n\n        return new Promise((resolve, reject) => {\n            this.put(url, headers, body, (err, result) => {\n                if (!err) {\n                    resolve(result);\n                } else {\n                    reject(err);\n                }\n            });\n        });\n    };\n\n    // Make a request to API.\n    // Syntax: .request(method, uri, [query], callback)\n    private request(method: string, url: string, headers: any, bodyOrCallback?: any | RequestCallback, callback?: RequestCallback): void {\n        let body: any;\n\n        if (callback) {\n            body = bodyOrCallback;\n        } else {\n            callback = bodyOrCallback;\n            body = {};\n        }\n\n        let options: request.Options = {\n            url: url,\n            method: method,\n            headers: headers,\n            form: body,\n        };\n\n        let requestCallback = function (err: any, response: any, responseBody: any): void {\n            if (!err && response.statusCode >= 400) {\n                err = new Error(responseBody);\n                err.statusCode = response.statusCode;\n                err.responseBody = responseBody;\n                err.statusMessage = http.STATUS_CODES[response.statusCode];\n            }\n\n            callback(err, responseBody);\n        };\n\n        switch (method.toLowerCase())\n        {\n            case \"get\":\n                request.get(options, requestCallback);\n                break;\n            case \"post\":\n                request.post(options, requestCallback);\n                break;\n            case \"put\":\n                request.put(options, requestCallback);\n                break;\n            case \"delete\":\n                request.delete(options, requestCallback);\n                break;\n        }\n    };\n}\n"],"sourceRoot":"/app/build"}