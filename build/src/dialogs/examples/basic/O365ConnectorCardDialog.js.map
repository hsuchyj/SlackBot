{"version":3,"sources":["../src/dialogs/examples/basic/O365ConnectorCardDialog.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,sCAAsC;AACtC,4EAAyE;AACzE,wDAAqD;AACrD,gEAA6D;AAC7D,mDAAiD;AAEjD,6BAAqC,SAAQ,yCAAmB;IAEpD,MAAM,CAAO,KAAK,CAAC,OAAwB,EAAE,IAAuC,EAAE,IAAkD;;YAC5I,qHAAqH;YACrH,IAAI,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;YAEhD,IAAI,GAAG,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;YACvC,IAAI,QAAQ,GAAQ,EAAE,CAAC;YACvB,QAAQ,CAAC,WAAW,GAAG,oDAAoD,CAAC;YAE5E,wCAAwC;YACxC,IAAI,wBAAwB,GAAQ;gBAChC,KAAK,EAAE,OAAO,CAAC,OAAO,CAAC,gBAAO,CAAC,aAAa,CAAC;gBAC7C,QAAQ,EAAE;oBACN;wBACI,IAAI,EAAE,OAAO,CAAC,OAAO,CAAC,gBAAO,CAAC,YAAY,CAAC,GAAG,GAAG;qBACpD;oBACD;wBACI,IAAI,EAAE,OAAO,CAAC,OAAO,CAAC,gBAAO,CAAC,YAAY,CAAC,GAAG,GAAG;qBACpD;iBACJ;aACJ,CAAC;YAEF,QAAQ,CAAC,OAAO,GAAG,wBAAwB,CAAC;YAE5C;;;;;;;;;;;;;eAaG;YAEH,wDAAwD;YACxD,IAAI,WAAW,KAAK,GAAG,EAAE;gBACrB,QAAQ,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;aA4B7B,CAAC,CAAC;aACN;YAED,wDAAwD;YACxD,IAAI,WAAW,KAAK,GAAG,EAAE;gBACrB,QAAQ,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC;;;;;;;;;;;;;;;;;;;;;;;;aAwB7B,CAAC,CAAC;aACN;YAED,GAAG,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YAC5B,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAClB,OAAO,CAAC,SAAS,EAAE,CAAC;QACxB,CAAC;KAAA;IAED,YACI,GAAyB;QAEzB,KAAK,CAAC,GAAG,EACL,qBAAS,CAAC,yBAAyB,EACnC,6BAAa,CAAC,4BAA4B,EAC1C,uBAAuB,CAAC,KAAK,CAChC,CAAC;IACN,CAAC;CACJ;AApHD,0DAoHC","file":"O365ConnectorCardDialog.js","sourcesContent":["import * as builder from \"botbuilder\";\nimport { TriggerActionDialog } from \"../../../utils/TriggerActionDialog\";\nimport { DialogIds } from \"../../../utils/DialogIds\";\nimport { DialogMatches } from \"../../../utils/DialogMatches\";\nimport { Strings } from \"../../../locale/locale\";\n\nexport class O365ConnectorCardDialog extends TriggerActionDialog {\n\n    private static async step1(session: builder.Session, args?: any | builder.IDialogResult<any>, next?: (args?: builder.IDialogResult<any>) => void): Promise<void> {\n        // get the input number for the example to show if the user passed it into the command - e.g. 'show connector card 2'\n        let inputNumber = args.intent.matched[1].trim();\n\n        let msg = new builder.Message(session);\n        let o365Card: any = {};\n        o365Card.contentType = \"application/vnd.microsoft.teams.card.o365connector\";\n\n        // this is the default example's content\n        let o365ConnectorCardContent: any = {\n            title: session.gettext(Strings.default_title),\n            sections: [\n                {\n                    text: session.gettext(Strings.default_text) + \"1\",\n                },\n                {\n                    text: session.gettext(Strings.default_text) + \"2\",\n                },\n            ],\n        };\n\n        o365Card.content = o365ConnectorCardContent;\n\n        /**\n         * Below are a few more examples of more complex connector cards\n         * The default card's content will be overwritten if a different option is desired\n         * and its number passed into the call to the bot\n         *\n         * To use: simply call 'show connector card 2' or 'show connector card 3'\n         *\n         * Note: these examples are just filled with demo data and that demo data is NOT using the localization system\n         * as shown above\n         *\n         * Note: these examples are leveraging an actual JSON string as their input content - more examples can be found at\n         * https://messagecardplayground.azurewebsites.net/ - it is recommended that the developer use the method\n         * shown above in order to get the benefits of type checking from the teams.O365ConnectorCard interface\n         */\n\n        // Overwrite default card content if option 2 is desired\n        if (inputNumber === \"2\") {\n            o365Card.content = JSON.parse(`\n                {\n                    \"themeColor\": \"fe9a13\",\n                    \"sections\": [\n                        {\n                            \"title\": \"**New major event on omi10svr**\",\n                            \"activityTitle\": \"Batch upload for TAX data on db-srv-hr1 aborted due to timeout. (ref324)\",\n                            \"facts\": [\n                                {\n                                    \"name\": \"Receive Time\",\n                                    \"value\": \"2016-05-30T16:50:02.503Z\"\n                                },\n                                {\n                                    \"name\": \"Node\",\n                                    \"value\": \"omi10svr\"\n                                },\n                                {\n                                    \"name\": \"Category\",\n                                    \"value\": \"job\"\n                                },\n                                {\n                                    \"name\": \"Priority\",\n                                    \"value\": \"medium\"\n                                }\n                            ]\n                        }\n                    ]\n                }\n            `);\n        }\n\n        // Overwrite default card content if option 3 is desired\n        if (inputNumber === \"3\") {\n            o365Card.content = JSON.parse(`\n                {\n                    \"summary\": \"Issue 176715375\",\n                    \"themeColor\": \"0078D7\",\n                    \"title\": \"Issue opened: Push notifications not working\",\n                    \"sections\": [\n                        {\n                            \"activityTitle\": \"Miguel Garcie\",\n                            \"activitySubtitle\": \"9/13/2016, 11:46am\",\n                            \"activityImage\": \"http://connectorsdemo.azurewebsites.net/images/MSC12_Oscar_002.jpg\",\n                            \"facts\": [\n                                {\n                                    \"name\": \"Repository:\",\n                                    \"value\": \"mgarcia\\\\test\"\n                                },\n                                {\n                                    \"name\": \"Issue #:\",\n                                    \"value\": \"176715375\"\n                                }\n                            ],\n                            \"text\": \"There is a problem with Push notifications, they don't seem to be picked up by the connector.\"\n                        }\n                    ]\n                }\n            `);\n        }\n\n        msg.addAttachment(o365Card);\n        session.send(msg);\n        session.endDialog();\n    }\n\n    constructor(\n        bot: builder.UniversalBot,\n    ) {\n        super(bot,\n            DialogIds.O365ConnectorCardDialogId,\n            DialogMatches.O365ConnectorCardDialogMatch,\n            O365ConnectorCardDialog.step1,\n        );\n    }\n}\n"],"sourceRoot":"/app/build"}