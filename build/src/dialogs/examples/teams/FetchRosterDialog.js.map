{"version":3,"sources":["../src/dialogs/examples/teams/FetchRosterDialog.ts"],"names":[],"mappings":";;;;;;;;;;AACA,4EAAyE;AACzE,4DAAkE;AAClE,wDAAqD;AACrD,gEAA6D;AAG7D,uBAA+B,SAAQ,yCAAmB;IAE9C,MAAM,CAAO,kBAAkB,CAAC,OAAwB,EAAE,IAAuC,EAAE,IAAkD;;YACzJ,yCAAyC;YACzC,IAAI,kBAAkB,GAAI,OAAO,CAAC,SAAsC,CAAC;YACzE,IAAI,UAAU,GAAI,OAAO,CAAC,OAAO,CAAC,OAAyC,CAAC;YAC5E,IAAI,aAAa,GAAG,UAAU,CAAC,UAAU,CAAC;YAE1C,sEAAsE;YACtE,IAAI,MAAM,GAAG,IAAI,CAAC;YAClB,IAAI,kCAAoB,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;gBACvC,MAAM,GAAG,OAAO,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC;aAChD;iBAAM;gBACH,MAAM,GAAG,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,YAAY,CAAC,EAAE,CAAC;aACpD;YAED,kBAAkB,CAAC,YAAY,CAC3B,aAAa,EACb,MAAM,EACN,CAAC,GAAG,EAAE,MAAM,EAAE,EAAE;gBACZ,IAAI,CAAC,GAAG,EAAE;oBACN,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;iBACxC;qBAAM;oBACH,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;iBACtB;gBACD,OAAO,CAAC,SAAS,EAAE,CAAC;YACxB,CAAC,CACJ,CAAC;QACN,CAAC;KAAA;IAED,YACI,GAAyB;QAEzB,KAAK,CAAC,GAAG,EACL,qBAAS,CAAC,mBAAmB,EAC7B,6BAAa,CAAC,sBAAsB,EACpC,iBAAiB,CAAC,kBAAkB,CACvC,CAAC;IACN,CAAC;CACJ;AAvCD,8CAuCC","file":"FetchRosterDialog.js","sourcesContent":["import * as builder from \"botbuilder\";\nimport { TriggerActionDialog } from \"../../../utils/TriggerActionDialog\";\nimport { isMessageFromChannel } from \"../../../utils/DialogUtils\";\nimport { DialogIds } from \"../../../utils/DialogIds\";\nimport { DialogMatches } from \"../../../utils/DialogMatches\";\nimport * as teams from \"botbuilder-teams\";\n\nexport class FetchRosterDialog extends TriggerActionDialog {\n\n    private static async fetchRosterPayload(session: builder.Session, args?: any | builder.IDialogResult<any>, next?: (args?: builder.IDialogResult<any>) => void): Promise<void> {\n        // casting to keep away typescript errors\n        let teamsChatConnector = (session.connector as teams.TeamsChatConnector);\n        let msgAddress = (session.message.address as builder.IChatConnectorAddress);\n        let msgServiceUrl = msgAddress.serviceUrl;\n\n        // if a message is from a channel, use the team.id to fetch the roster\n        let currId = null;\n        if (isMessageFromChannel(session.message)) {\n            currId = session.message.sourceEvent.team.id;\n        } else {\n            currId = session.message.address.conversation.id;\n        }\n\n        teamsChatConnector.fetchMembers(\n            msgServiceUrl,\n            currId,\n            (err, result) => {\n                if (!err) {\n                    session.send(JSON.stringify(result));\n                } else {\n                    session.error(err);\n                }\n                session.endDialog();\n            },\n        );\n    }\n\n    constructor(\n        bot: builder.UniversalBot,\n    ) {\n        super(bot,\n            DialogIds.FetchRosterDialogId,\n            DialogMatches.FetchRosterDialogMatch,\n            FetchRosterDialog.fetchRosterPayload,\n        );\n    }\n}\n"],"sourceRoot":"/app/build"}