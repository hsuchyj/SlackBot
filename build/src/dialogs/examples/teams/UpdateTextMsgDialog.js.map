{"version":3,"sources":["../src/dialogs/examples/teams/UpdateTextMsgDialog.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,sCAAsC;AACtC,4EAAyE;AACzE,wDAAqD;AACrD,gEAA6D;AAC7D,mDAAiD;AAEjD,yBAAiC,SAAQ,yCAAmB;IAEhD,MAAM,CAAO,iBAAiB,CAAC,OAAwB,EAAE,IAAuC,EAAE,IAAkD;;YACxJ,IAAI,OAAO,CAAC,gBAAgB,CAAC,eAAe,EAAE;gBAC1C,IAAI,GAAG,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC;qBACjC,OAAO,CAAC,OAAO,CAAC,gBAAgB,CAAC,eAAe,CAAC;qBACjD,IAAI,CAAC,gBAAO,CAAC,gBAAgB,CAAC,CAAC;gBAEpC,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,CAAC,SAAS,EAAE,EAAE,CAAC,GAAG,EAAE,OAAO,EAAE,EAAE;oBACvD,IAAI,CAAC,GAAG,EAAE;wBACN,4EAA4E;wBAC5E,OAAO,CAAC,IAAI,CAAC,gBAAO,CAAC,wBAAwB,CAAC,CAAC;qBAClD;yBAAM;wBACH,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;qBACtB;oBACD,OAAO,CAAC,SAAS,EAAE,CAAC;gBACxB,CAAC,CAAC,CAAC;aACN;iBAAM;gBACH,OAAO,CAAC,IAAI,CAAC,gBAAO,CAAC,gBAAgB,CAAC,CAAC;gBACvC,OAAO,CAAC,SAAS,EAAE,CAAC;aACvB;QACL,CAAC;KAAA;IAED,YACI,GAAyB;QAEzB,KAAK,CAAC,GAAG,EACL,qBAAS,CAAC,qBAAqB,EAC/B,6BAAa,CAAC,wBAAwB,EACtC,mBAAmB,CAAC,iBAAiB,CACxC,CAAC;IACN,CAAC;CACJ;AAhCD,kDAgCC","file":"UpdateTextMsgDialog.js","sourcesContent":["import * as builder from \"botbuilder\";\nimport { TriggerActionDialog } from \"../../../utils/TriggerActionDialog\";\nimport { DialogIds } from \"../../../utils/DialogIds\";\nimport { DialogMatches } from \"../../../utils/DialogMatches\";\nimport { Strings } from \"../../../locale/locale\";\n\nexport class UpdateTextMsgDialog extends TriggerActionDialog {\n\n    private static async updateTextMessage(session: builder.Session, args?: any | builder.IDialogResult<any>, next?: (args?: builder.IDialogResult<any>) => void): Promise<void> {\n        if (session.conversationData.lastTextMessage) {\n            let msg = new builder.Message(session)\n                .address(session.conversationData.lastTextMessage)\n                .text(Strings.updated_text_msg);\n\n            session.connector.update(msg.toMessage(), (err, address) => {\n                if (!err) {\n                    // do not need to save the incoming address because Teams does not change it\n                    session.send(Strings.updated_msg_confirmation);\n                } else {\n                    session.error(err);\n                }\n                session.endDialog();\n            });\n        } else {\n            session.send(Strings.no_msg_to_update);\n            session.endDialog();\n        }\n    }\n\n    constructor(\n        bot: builder.UniversalBot,\n    ) {\n        super(bot,\n            DialogIds.UpdateTextMsgDialogId,\n            DialogMatches.UpdateTextMsgDialogMatch,\n            UpdateTextMsgDialog.updateTextMessage,\n        );\n    }\n}\n"],"sourceRoot":"/app/build"}