{"version":3,"sources":["../src/middleware/RestrictIncomingMessagesToTenants.ts"],"names":[],"mappings":";;AACA,iCAAiC;AAEjC,2CAA2C;AAC3C;IAAA;QAEoB,eAAU,GAAG,CAAC,OAAwB,EAAE,IAAc,EAAQ,EAAE;YAC9E,IAAI,YAAY,GAAG,MAAM,CAAC,qBAAqB,CAAC;YAChD,IAAI,gBAAgB,GAAG,OAAO,CAAC,OAAO,CAAC,WAAW,CAAC,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,WAAW,CAAC,MAAM,CAAC,EAAE,CAAC;YACnG,IAAI,YAAY,IAAI,YAAY,KAAK,OAAO,EAAE;gBAC1C,IAAI,YAAY,KAAK,gBAAgB,EAAE;oBACrC,IAAI,EAAE,CAAC;iBACR;qBAAM;oBACL,OAAO,CAAC,IAAI,CAAC,iEAAiE,GAAG,gBAAgB,GAAG,qBAAqB,CAAC,CAAC;iBAC5H;aACF;iBACI;gBACH,IAAI,EAAE,CAAC;aACR;QACL,CAAC,CAAA;IACL,CAAC;CAAA;AAhBD,8EAgBC","file":"RestrictIncomingMessagesToTenants.js","sourcesContent":["import * as builder from \"botbuilder\";\nimport * as config from \"config\";\n\n// Strip bot mentions from the message text\nexport class RestrictIncomingMessagesToTenants implements builder.IMiddlewareMap {\n\n    public readonly botbuilder = (session: builder.Session, next: Function): void => {\n      let targetTenant = config.office365TenantFilter;\n      let currentMsgTenant = session.message.sourceEvent.tenant && session.message.sourceEvent.tenant.id;\n      if (targetTenant && targetTenant !== \"#ANY#\") {\n          if (targetTenant === currentMsgTenant) {\n            next();\n          } else {\n            session.send(\"MS Teams: Attempted access from a different Office 365 tenant (\" + currentMsgTenant + \"): message rejected\");\n          }\n        }\n        else {\n          next();\n        }\n    }\n}\n"],"sourceRoot":"/app/build"}