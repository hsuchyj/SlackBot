{"version":3,"sources":["../src/pages/DefaultTab.ts"],"names":[],"mappings":";;;;;;;;;;AACA,IAAI,EAAE,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;AACvB,IAAI,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;AAC3B,iCAAiC;AAEjC;IAEW,MAAM,CAAC,iBAAiB;QAC3B,OAAO,UAAgB,GAAQ,EAAE,GAAQ,EAAE,IAAS;;gBAChD,IAAI;oBACA,IAAI,QAAQ,GAAG;;;;;;;;;;;;;6BAaF,CAAC;oBAEd,IAAI,KAAK,GAAG,EAAE,CAAC,WAAW,CAAC,yBAAyB,CAAC,CAAC;oBACtD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;wBACnC,IAAI,QAAQ,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;wBACxB,IAAI,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC;wBACzC,IAAI,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC;wBAC7C,IAAI,aAAa,KAAK,MAAM,EAAE;4BAC1B,QAAQ,IAAI;kDACc,GAAG,QAAQ,GAAI,QAAQ,GAAG,QAAQ,GAAG,SAAS,CAAC;yBAC5E;qBACJ;oBAED,QAAQ,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;iDA0BqB,MAAM,CAAC,GAAG,CAAC,aAAa,CAAC,GAAG,cAAc;;;;;;;;;;;;;;4BAc/D,CAAC;oBAEb,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;iBACtB;gBAAC,OAAO,CAAC,EAAE;oBACR,qFAAqF;oBACrF,GAAG,CAAC,IAAI,CAAC;;;;;;;;4BAQG,CAAC,CAAC;iBACjB;YACL,CAAC;SAAA,CAAC;IACN,CAAC;CACJ;AAxFD,gCAwFC","file":"DefaultTab.js","sourcesContent":["import * as express from \"express\";\nlet fs = require(\"fs\");\nlet path = require(\"path\");\nimport * as config from \"config\";\n\nexport class DefaultTab {\n\n    public static getRequestHandler(): express.RequestHandler {\n        return async function (req: any, res: any, next: any): Promise<void> {\n            try {\n                let htmlPage = `<!DOCTYPE html>\n                    <html>\n                    <head>\n                        <title>Bot Info</title>\n                        <meta charset=\"utf-8\" />\n                        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n                        <script src='https://statics.teams.microsoft.com/sdk/v1.0/js/MicrosoftTeams.min.js'></script>\n                        <script src='https://code.jquery.com/jquery-1.11.3.min.js'></script>\n                    </head>\n\n                    <body>\n                        <p>\n                            These are links to the source code for all of the example dialogs given in the template.\n                        </p>`;\n\n                let files = fs.readdirSync(\"./public/exampleDialogs\");\n                for (let i = 0; i < files.length; i++) {\n                    let currFile = files[i];\n                    let fileName = path.parse(currFile).name;\n                    let fileExtension = path.parse(currFile).ext;\n                    if (fileExtension === \".txt\") {\n                        htmlPage += `<br>\n                        <a href=\"/exampleDialogs/` + fileName +  `.txt\">` + fileName + `.ts</a>`;\n                    }\n                }\n\n                htmlPage += `\n                    <br>\n                    <br>\n                    <br>\n                    <br>\n                    <p id=\"currentTheme\">Current theme will show here when you change it in Teams settings - it can be found on the initial load by fetching the context</p>\n                    <br>\n                    <button onclick=\"showAllCommands()\">Click to See All Commands</button>\n                    <br>\n                    <p>NOTE: Trying to get the deeplink when this is a static tab does not work. This feature only works when this is a configurable tab.</p>\n                    <button onclick=\"getDeeplink()\">Click to get a deeplink to this tab</button>\n                    <br>\n                    <br>\n                    <button onclick=\"showContext()\">Click to Show Tab's Context</button>\n                    <p id=\"contextOutput\"></p>\n                    <script>\n                        var microsoftTeams;\n\n                        $(document).ready(function () {\n                            microsoftTeams.initialize();\n                            microsoftTeams.registerOnThemeChangeHandler(function(theme) {\n                                document.getElementById('currentTheme').innerHTML = theme;\n                            });\n                        });\n\n                        function showAllCommands() {\n                            window.location = \"${config.get(\"app.baseUri\") + \"/allCommands\"}\";\n                        }\n\n                        function getDeeplink() {\n                            microsoftTeams.shareDeepLink({subEntityId: 'stuff', subEntityLabel: 'stuff2'});\n                        }\n\n                        function showContext() {\n                            microsoftTeams.getContext((context) => {\n                                document.getElementById('contextOutput').innerHTML = JSON.stringify(context);\n                            });\n                        }\n                    </script>\n                    </body>\n                    </html>`;\n\n                res.send(htmlPage);\n            } catch (e) {\n                // Don't log expected errors - error is probably from there not being example dialogs\n                res.send(`<html>\n                    <body>\n                    <p>\n                        Sorry. There are no example dialogs to display.\n                    </p>\n                    <br>\n                    <img src=\"/tab/error_generic.png\" alt=\"default image\" />\n                    </body>\n                    </html>`);\n            }\n        };\n    }\n}\n"],"sourceRoot":"/app/build"}