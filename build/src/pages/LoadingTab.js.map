{"version":3,"sources":["../src/pages/LoadingTab.ts"],"names":[],"mappings":";;;;;;;;;;AAEA;IAEW,MAAM,CAAC,iBAAiB;QAC3B,OAAO,UAAgB,GAAQ,EAAE,GAAQ,EAAE,IAAS;;gBAChD,IAAI;oBACA,IAAI,QAAQ,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;4BAgCH,CAAC;oBAEb,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;iBACtB;gBAAC,OAAO,CAAC,EAAE;oBACR,GAAG,CAAC,IAAI,CAAC;;;;;;;;4BAQG,CAAC,CAAC;iBACjB;YACL,CAAC;SAAA,CAAC;IACN,CAAC;CACJ;AArDD,gCAqDC","file":"LoadingTab.js","sourcesContent":["import * as express from \"express\";\n\nexport class LoadingTab {\n\n    public static getRequestHandler(): express.RequestHandler {\n        return async function (req: any, res: any, next: any): Promise<void> {\n            try {\n                let htmlPage = `<!DOCTYPE html>\n                    <html>\n                    <head>\n                        <title>Bot Info</title>\n                        <meta charset=\"utf-8\" />\n                        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n                        <script src='https://statics.teams.microsoft.com/sdk/v1.0/js/MicrosoftTeams.min.js'></script>\n                        <script src='https://code.jquery.com/jquery-1.11.3.min.js'></script>\n                    </head>\n\n                    <body>\n                        <script>\n                            var microsoftTeams;\n\n                            $(document).ready(function () { \n                                microsoftTeams.initialize();\n                            \n                                microsoftTeams.getContext((context) => {\n                                    switch (context.subEntityId) {\n                                        case 'allCommands':\n                                            window.location = window.location.protocol + '//' + window.location.host + '/allCommands';\n                                            break;\n                                        case 'vstsAuth':\n                                            window.location = window.location.protocol + '//' + window.location.host + '/vstsAuth';\n                                            break;\n                                        default:\n                                            window.location = window.location.protocol + '//' + window.location.host + '/default';\n                                    }\n                                });\n                            });\n                        </script>\n                    </body>\n                    </html>`;\n\n                res.send(htmlPage);\n            } catch (e) {\n                res.send(`<html>\n                    <body>\n                    <p>\n                        Sorry. There was an error.\n                    </p>\n                    <br>\n                    <img src=\"/tab/error_generic.png\" alt=\"default image\" />\n                    </body>\n                    </html>`);\n            }\n        };\n    }\n}\n"],"sourceRoot":"/app/build"}