{"version":3,"sources":["../src/pages/VSTSAuthFlowEndPopUp.ts"],"names":[],"mappings":";;;;;;;;;;AAEA;IAEW,MAAM,CAAC,iBAAiB;QAC3B,OAAO,UAAgB,GAAQ,EAAE,GAAQ,EAAE,IAAS;;gBAChD,IAAI;oBACA,IAAI,QAAQ,GAAG;;;;;;;;;;;;;;;;;;;;;;4BAsBH,CAAC;oBAEb,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;iBACtB;gBAAC,OAAO,CAAC,EAAE;oBACR,GAAG,CAAC,IAAI,CAAC;;;;;;;;4BAQG,CAAC,CAAC;iBACjB;YACL,CAAC;SAAA,CAAC;IACN,CAAC;CACJ;AA3CD,oDA2CC","file":"VSTSAuthFlowEndPopUp.js","sourcesContent":["import * as express from \"express\";\n\nexport class VSTSAuthFlowEndPopUp {\n\n    public static getRequestHandler(): express.RequestHandler {\n        return async function (req: any, res: any, next: any): Promise<void> {\n            try {\n                let htmlPage = `<!DOCTYPE html>\n                    <html>\n                    <head>\n                        <title>Bot Info</title>\n                        <meta charset=\"utf-8\" />\n                        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n                        <script src='https://statics.teams.microsoft.com/sdk/v1.0/js/MicrosoftTeams.min.js'></script>\n                        <script src='https://code.jquery.com/jquery-1.11.3.min.js'></script>\n                    </head>\n\n                    <body>\n                        <p>Auth Flow End</p>\n                        <script>\n                            var microsoftTeams;\n\n                            $(document).ready(function () { \n                                microsoftTeams.initialize();\n                            \n                                microsoftTeams.authentication.notifySuccess('Success!!! You are now logged in to use the bot and the tab.');\n                            });\n                        </script>\n                    </body>\n                    </html>`;\n\n                res.send(htmlPage);\n            } catch (e) {\n                res.send(`<html>\n                    <body>\n                    <p>\n                        Sorry. There was an error.\n                    </p>\n                    <br>\n                    <img src=\"/tab/error_generic.png\" alt=\"default image\" />\n                    </body>\n                    </html>`);\n            }\n        };\n    }\n}\n"],"sourceRoot":"/app/build"}